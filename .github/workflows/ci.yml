name: CI

on: [push]

jobs:
  check:

    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v1
    - uses: actions/setup-java@v1
      with:
        java-version: '9.0.4' // The JDK version to make available on the path. Takes a whole or semver Jdk version, or 1.x syntax (e.g. 1.8 => Jdk 8.x)
        architecture: x64 // (x64 or x86) - defaults to x64
    - name: yarn install
      run:  sudo apt-get update && sudo apt-get install yarn
    - name: package install
      run:  yarn
    - name: lint
      run:  yarn lint:output
    - name: test
      run:  yarn test:cov
    - name: sonar scan
      env:
        SONAR_KEY: ${{ secrets.SONAR_KEY }}
      run: yarn sonarqube-scanner -Dsonar.login=$SONAR_KEY
