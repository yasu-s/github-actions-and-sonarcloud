name: CI

on: [push]

jobs:
  check:

    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v1
    - name: setup JDK 1.8
      uses: actions/setup-java@v1
      with:
        java-version: 1.8
    - name: yarn install
      run:  sudo apt-get update && sudo apt-get install yarn
    - name: package install
      run:  yarn
    - name: lint
      run:  yarn lint:output
    - name: test
      run:  yarn test:cov
    - name: sonar scan
      env:
        SONAR_KEY: ${{ secrets.SONAR_KEY }}
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      run: yarn sonarqube-scanner -Dsonar.login=$SONAR_KEY
